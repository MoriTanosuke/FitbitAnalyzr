<div id="import-sleep-<%= import.date %>"></div>
<%= javascript_include_tag "https://www.google.com/jsapi" %>
<script type="text/javascript">
google.load('visualization', '1.0', {'packages':['corechart']});
google.setOnLoadCallback(drawChart);
function drawChart() {
  var options = {'title':'Sleep over time'};
  var chart = new google.visualization.ColumnChart(document.getElementById('import-sleep-<%= import.date %>'));
  var data = new google.visualization.DataTable();
  data.addColumn('string', 'Date');
  data.addColumn('number', 'Awake');
  var d = <%= import.data.html_safe %>;
  for(var row in d["sleep"]) { 
    data.addRow(['<%= import.date %>', parseFloat(d["sleep"][row]["duration"])]);
    chart.draw(data, options);
  }
}
</script>

